<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”¢å“ä¾›è²¨æƒ…å½¢</title>
    <style>
        /* ==================== åŸºç¤èˆ‡é›»è…¦ç‰ˆæ¨£å¼ (æ”¾å¤§å­—é«”) ==================== */
        body { font-family: Arial, sans-serif; margin: 30px; background-color: #f9f9f9; } 
        h1 { text-align: center; color: #196b24; font-size: 30pt; } 
        
        .section-title { color: #196b24; font-size: 14pt; font-weight: bold; margin-top: 14px; text-align: center; }
        .section-desc { color: #5e5e5e; font-size: 14pt; text-align: center; margin-bottom: 14px; }
        #update-date { text-align: center; margin-top: 40px; font-size: 12pt; color: #555; }

        table { 
            width: 100%; 
            border-collapse: collapse; 
            margin-bottom: 14px; 
            table-layout: auto; /* é›»è…¦ç‰ˆç¶­æŒè‡ªå‹•ä½ˆå±€ */
        } 
        th, td { 
            border: 1px solid #ddd; 
            padding: 14px; 
            text-align: center; 
            font-size: 12px; 
            word-wrap: break-word;
            box-sizing: border-box; /* ç¢ºä¿å¯¬åº¦è¨ˆç®—ä¸€è‡´æ€§ */
        }
        th { background-color: #f2f2f2; }


        /* ==================== æ‰‹æ©ŸéŸ¿æ‡‰å¼æ¨£å¼ (< 768px) ==================== */
        @media screen and (max-width: 768px) {
            
            body { margin: 12px; } 
            
            /* 1. å®¹å™¨ï¼šå¼·åˆ¶æ°´å¹³æ»¾å‹• */
            .table-responsive {
                overflow-x: auto; 
                width: 100%;     
                margin: 0 auto 12px auto;
            }

            /* 2. æ ¸å¿ƒä¿®æ­£ï¼šå›ºå®šä½ˆå±€ï¼Œä½†ç¸½å¯¬åº¦ç”± <colgroup> æ±ºå®š */
            table {
                /* ğŸ’¥ é€™è£¡ä¸å†è¨­å®šå›ºå®šå¯¬åº¦ï¼Œå¯¬åº¦ç”± colgroup æ±ºå®š */
                width: auto; 
                max-width: none;
                margin: 0;
                table-layout: fixed; /* ğŸ’¥ å•Ÿç”¨å›ºå®šä½ˆå±€ï¼Œç¢ºä¿æ¬„ä½å°é½Š */
            }
            
            /* 3. æ¢å¾©è¡¨æ ¼ display å±¬æ€§ */
            table, thead, tbody, th, td, tr { 
                display: table; 
                width: auto;
            }
            thead, tbody, tr { display: table-row; }
            
            /* 4. è¨­ç½® th å’Œ td æ¨£å¼ */
            th, td {
                display: table-cell; 
                padding: 10px 5px; 
                font-size: 12px;
                text-align: center;
                word-wrap: break-word; 
                white-space: normal; 
                /* ğŸ’¥ ç§»é™¤é€™è£¡çš„ width è¨­å®šï¼Œäº¤ç”± <colgroup> è² è²¬ */
                width: auto;
            }
            
            /* 5. ç§»é™¤å¡ç‰‡æ¨¡å¼çš„å½å…ƒç´  */
            thead tr, th {
                position: static; 
                display: table-cell !important; 
            }
            td:before { 
                content: none; 
            }
        }
    </style>
</head>
<body>
    <h1>ç”¢å“ä¾›è²¨æƒ…å½¢</h1>
    
    <div class="section-title">æš«æ™‚æ€§ç¼ºè²¨</div>
    <p class="section-desc">ä»¥ä¸‹ç”¢å“éŠ·å”®ç†±çƒˆä¾›è²¨ä¸åŠï¼Œå³å°‡æš«åœä¾›æ‡‰ï¼Œæ­£ç¢ºçµæŸæ—¥æœŸå¯èƒ½æœƒæ ¹æ“šå¯¦éš›éŠ·å”®ç‹€æ³ç•°å‹•ï¼Œæ•¬è«‹è¦‹è«’ã€‚ å¦‚æœæ‚¨çš„è‡ªé¸é å‚™è¨‚å–®åŒ…å«ä»¥ä¸‹ç”¢å“ï¼Œè«‹è‡³å®˜ç¶²â†’ é å‚™è¨‚å–®æ›´æ”¹ï¼Œæˆ–æ’¥æ‰“02-8787-5442ç”±å°ˆäººç‚ºæ‚¨æœå‹™ã€‚</p>
    
    <div class="table-responsive" id="data-container-temporary">
        <p style="text-align: center;">è³‡æ–™è¼‰å…¥ä¸­...</p>
    </div>
    
    <div class="section-title" style="margin-top: 10px;">åœæ­¢è²©å”®</div>
    <p class="section-desc"> æ„Ÿè¬æ‚¨çš„æ„›ç”¨ï¼Œä»¥ä¸‹ç”¢å“å·²å”®å®Œï¼ŒéŠ·å”®å®Œç•¢å¾Œä¸å†ä¾›è²¨ï¼Œè¬è¬ï¼</p>
    
    <div class="table-responsive" id="data-container-discontinued">
        <p style="text-align: center;">è³‡æ–™è¼‰å…¥ä¸­...</p>
    </div>
    
    <p id="update-date"></p>
    
    <script>
        // ğŸš¨ æ•¸æ“šé€£çµå®šç¾© (ä¿æŒä¸è®Š)
        const BASE_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSfLe7v1HVWF-H0fLihDiBfl5kY7ux-WNsBIASi4xF9Oj9CzGiKPZAoETBStCnKFHWPc7WEqwfLf4Fs/pub?single=true&output=csv';
        const URL_TEMPORARY = BASE_URL + '&gid=0';
        const URL_DISCONTINUED = BASE_URL + '&gid=261938866'; 

        // ----------------------------------------------------
        // æ•¸æ“šæ¸²æŸ“æ ¸å¿ƒå‡½æ•¸ (renderTable å‡½æ•¸æœ‰é‡å¤§è®Šå‹•)
        // ----------------------------------------------------

        // æ¸²æŸ“å–®ä¸€è¡¨æ ¼
        function renderTable(containerId, data) {
            const container = document.getElementById(containerId);
            
            if (!data || data.length === 0 || (data.length > 0 && Object.keys(data[0]).length === 0)) {
                if (containerId === 'data-container-discontinued') {
                     container.innerHTML = '<p style="text-align: center;">ç›®å‰ç„¡åœæ­¢è²©å”®çš„ç”¢å“ã€‚</p>';
                } else {
                     container.innerHTML = '<p style="text-align: center;">ç„¡ç”¢å“è³‡æ–™ã€‚</p>';
                }
                return;
            }

            const headers = Object.keys(data[0]);
            let tableHtml = '<table>';
            
            // ğŸ’¥ 1. æ–°å¢ <colgroup> ä¾†å¼·åˆ¶æ¬„ä½å¯¬åº¦
            let colgroupHtml = '<colgroup>';
            const numColumns = headers.length;
            
            // æ ¹æ“šæ‚¨çš„è¡¨æ ¼çµæ§‹ (SKU/ç”¢å“åç¨±/æ—¥æœŸ/æ—¥æœŸ)ï¼Œæ¡ç”¨æ··åˆå›ºå®šå¯¬åº¦
            const defaultColWidth = '150px'; // é è¨­æ‰€æœ‰æ¬„ä½ 150px
            
            for(let i = 0; i < numColumns; i++) {
                let colWidth = defaultColWidth;
                
                // å‡è¨­ï¼šç¬¬ä¸€æ¬„ (SKU) 80px
                if (i === 0) {
                    colWidth = '80px';
                } 
                // å‡è¨­ï¼šç¬¬äºŒæ¬„ (ç”¢å“åç¨±) 250px
                else if (i === 1) {
                    colWidth = '250px';
                }
                // å‰©é¤˜æ¬„ä½ (æ—¥æœŸ) 160px
                else {
                    colWidth = '160px';
                }
                
                colgroupHtml += `<col style="width: ${colWidth}; min-width: ${colWidth};">`;
            }
            colgroupHtml += '</colgroup>';
            tableHtml += colgroupHtml;
            
            // 2. ç”Ÿæˆè¡¨é ­ (<thead>)
            tableHtml += '<thead><tr>';
            headers.forEach(header => {
                tableHtml += `<th>${header}</th>`;
            });
            tableHtml += '</tr></thead><tbody>';

            // 3. ç”Ÿæˆè³‡æ–™åˆ— (<tbody>)
            data.forEach(rowData => {
                tableHtml += '<tr>';
                headers.forEach(header => {
                    const cellText = rowData[header] !== undefined ? rowData[header] : ''; 
                    const cleanHeader = header.trim();
                    tableHtml += `<td data-label="${cleanHeader}">${cellText}</td>`;
                });
                tableHtml += '</tr>';
            });

            tableHtml += '</tbody></table>';
            container.innerHTML = tableHtml;
        }

        // å¼·åŒ–å¾Œçš„ CSV è½‰ JSON å‡½æ•¸ (ä¿æŒä¸è®Š)
        function parseCSV(csvText) {
            const lines = csvText.split(/\r?\n/).filter(line => line.trim() !== '');
            if (lines.length <= 1) return [];
            const headerLine = lines[0].replace(/"/g, '');
            const headers = headerLine.split(',').map(header => header.trim());
            const result = [];

            for (let i = 1; i < lines.length; i++) {
                const row = lines[i];
                const values = row.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/).map(value => value.trim().replace(/"/g, ''));
                
                if (values.every(v => v === '')) continue; 

                const obj = {};
                for (let j = 0; j < headers.length; j++) {
                    const header = headers[j];
                    obj[header] = values[j] !== undefined ? values[j].trim() : '';
                }
                result.push(obj);
            }
            return result;
        }

        // ä¸»åŠ è¼‰å‡½æ•¸ (ä¿æŒä¸è®Š)
        async function loadAllSheets() {
            let lastModifiedDate = null;
            
            try {
                const response1 = await fetch(URL_TEMPORARY);
                if (!response1.ok) throw new Error(`HTTP Error: ${response1.status}`);
                const csvText1 = await response1.text();
                const data1 = parseCSV(csvText1);
                renderTable('data-container-temporary', data1);
                lastModifiedDate = response1.headers.get('Last-Modified');
            } catch (error) {
                console.error('è¼‰å…¥ã€Œæš«æ™‚æ€§ç¼ºè²¨ã€å¤±æ•—:', error);
                document.getElementById('data-container-temporary').innerHTML = `<p style="text-align: center; color: red;">è¼‰å…¥æš«æ™‚æ€§ç¼ºè²¨è³‡æ–™å¤±æ•—ã€‚è«‹æª¢æŸ¥ Google Sheets é€£çµã€‚éŒ¯èª¤: ${error.message || error.toString()}</p>`;
            }

            try {
                const response2 = await fetch(URL_DISCONTINUED);
                if (!response2.ok) throw new Error(`HTTP Error: ${response2.status}`);
                const csvText2 = await response2.text();
                const data2 = parseCSV(csvText2);
                renderTable('data-container-discontinued', data2);
                if (!lastModifiedDate) { 
                    lastModifiedDate = response2.headers.get('Last-Modified');
                }
            } catch (error) {
                console.error('è¼‰å…¥ã€Œåœæ­¢è²©å”®ã€å¤±æ•—:', error);
                document.getElementById('data-container-discontinued').innerHTML = `<p style="text-align: center; color: red;">è¼‰å…¥åœæ­¢è²©å”®è³‡æ–™å¤±æ•—ã€‚è«‹æª¢æŸ¥ Google Sheets é€£çµæˆ– GIDã€‚éŒ¯èª¤: ${error.message || error.toString()}</p>`;
            }
            
            const dateElement = document.getElementById('update-date');
            let updateText = 'ç„¡æ³•ç²å–æ›´æ–°æ™‚é–“';
            
            if (lastModifiedDate) {
                const date = new Date(lastModifiedDate);
                const year = date.getFullYear();
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const day = String(date.getDate()).padStart(2, '0');
                updateText = `${year}/${month}/${day}`;
            } else {
                const now = new Date();
                const year = now.getFullYear();
                const month = String(now.getMonth() + 1).padStart(2, '0');
                const day = String(now.getDate()).padStart(2, '0');
                updateText = `${year}/${month}/${day}`;
            }
            
            if(dateElement) {
                 dateElement.textContent = `æœ€å¾Œæ›´æ–°æ—¥æœŸ : ${updateText}`;
            }
        }

        // å•Ÿå‹•ä¸»å‡½æ•¸
        loadAllSheets();
    </script>
</body>
</html>
